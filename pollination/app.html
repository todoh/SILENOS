<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silenos Pollination - App Workspace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        .transparency-bg {
            background-image: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%), linear-gradient(-45deg, rgba(255,255,255,0.1) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.1) 75%), linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.1) 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            background-color: #0f0f0f;
        }
        .transparency-bg-lightbox {
            background-image: linear-gradient(45deg, #1f1f1f 25%, transparent 25%), linear-gradient(-45deg, #1f1f1f 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #1f1f1f 75%), linear-gradient(-45deg, transparent 75%, #1f1f1f 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            background-color: #0a0a0c;
        }

        .toggle-checkbox:checked + .toggle-label { background-color: #a855f7; }
        .toggle-label {
            width: 36px; height: 20px; background-color: rgba(255,255,255,0.1);
            border-radius: 999px; position: relative; cursor: pointer; transition: background-color 0.2s; border: 1px solid rgba(255,255,255,0.05);
        }
        .toggle-circle {
            width: 14px; height: 14px; background-color: white; border-radius: 50%;
            position: absolute; top: 2px; left: 2px; transition: transform 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        .toggle-checkbox:checked + .toggle-label .toggle-circle { transform: translateX(16px); }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: '#050505',
                        panel: 'rgba(10, 10, 12, 0.6)', 
                        borderGlow: 'rgba(255, 255, 255, 0.03)' 
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-dark text-gray-200 h-screen w-screen overflow-hidden flex font-sans selection:bg-purple-500 selection:text-white relative">

    <nav class="w-64 h-full flex flex-col py-6 border-r border-borderGlow bg-panel backdrop-blur-2xl z-20 relative">
        <div onclick="showLanding()" class="mb-10 px-6 flex items-center gap-3 text-white font-bold tracking-tighter cursor-pointer hover:scale-105 transition-transform origin-left pointer-events-auto">
            <i class="fa-solid fa-seedling text-purple-500 filter drop-shadow-[0_0_8px_rgba(168,85,247,0.5)] text-2xl"></i>
            <span class="text-xl tracking-wide">SILEN<span style="color: red;" >OS</span> X Pollination</span>
        </div>

        <div class="flex-1 flex flex-col gap-2 w-full px-4" id="tool-menu">
            <button class="tool-btn active group" data-tool="video">
                <i class="fa-solid fa-film"></i>
                <span data-i18n="tool_video">Video</span>
            </button>
            <button class="tool-btn group" data-tool="image">
                <i class="fa-solid fa-image"></i>
                <span data-i18n="tool_image">Image</span>
            </button>
            <button class="tool-btn group" data-tool="music">
                <i class="fa-solid fa-music"></i>
                <span data-i18n="tool_music">Music</span>
            </button>
            <button class="tool-btn group" data-tool="voice">
                <i class="fa-solid fa-microphone"></i>
                <span data-i18n="tool_voice">Voice</span>
            </button>
            <button class="tool-btn group" data-tool="chat">
                <i class="fa-solid fa-message"></i>
                <span data-i18n="tool_chat">Chat</span>
            </button>
        </div>
    </nav>

    <main class="flex-1 h-full flex flex-col relative">
        <header class="absolute top-0 left-0 w-full h-16 flex items-center justify-between px-8 z-10 pointer-events-none">
            <h1 id="current-tool-title" class="text-xl font-medium tracking-wide pointer-events-auto" data-i18n="tool_video">Video</h1>
            
            <div class="flex items-center gap-4 pointer-events-auto">
                <div class="relative group bg-white/5 rounded-lg p-2 border border-white/5 hover:bg-white/10 transition-colors flex items-center">
                    <i class="fa-solid fa-globe text-gray-500 text-sm"></i>
                    <select id="language-selector" class="appearance-none bg-transparent text-xs text-gray-400 font-bold uppercase cursor-pointer hover:text-white transition-colors text-right outline-none w-full ml-2">
                        <option value="en" class="bg-gray-900">English</option>
                        <option value="es" class="bg-gray-900">EspaÃ±ol</option>
                        <option value="ca" class="bg-gray-900">CatalÃ </option>
                        <option value="fr" class="bg-gray-900">FranÃ§ais</option>
                    </select>
                </div>

                <div id="connection-status" class="flex items-center gap-2 ml-2">
                    <div class="w-2 h-2 rounded-full bg-red-500" id="status-dot"></div>
                    <span class="text-xs text-gray-400 font-mono" id="status-text" data-i18n="status_disconnected">Disconnected</span>
                </div>
                
                <button onclick="toggleLoginModal()" class="bg-[#141416]/80 hover:bg-[#1f1f23] border border-white/10 text-white px-4 py-2 rounded-xl text-sm font-medium transition-all backdrop-blur-md flex items-center gap-2 shadow-lg ml-2" id="header-login-btn">
                    <i class="fa-solid fa-key text-purple-400"></i>
                    <span data-i18n="login_button_header">Connect API</span>
                </button>
            </div>
        </header>

        <div id="app-canvas" class="flex-1 w-full h-full pt-20 px-8 pb-8 overflow-y-auto custom-scrollbar relative">
            
            <div id="section-video" class="tool-section w-full h-full flex gap-6 fade-in">
                <div class="w-80 shrink-0 flex flex-col gap-6 bg-panel border border-white/5 rounded-2xl p-6 overflow-y-auto custom-scrollbar shadow-xl">
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="video_prompt_label">Video Prompt</label>
                        <textarea id="video-prompt" rows="5" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-3 outline-none resize-none placeholder-gray-600 transition-colors" data-i18n-placeholder="video_prompt_placeholder" placeholder="Describe action, kinematics, lighting..."></textarea>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="model_label">AI Model</label>
                        <select id="video-model" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono cursor-pointer appearance-none">
                            <option value="ltx-2">LTX-2 ğŸ’ (20ğŸ¬ 0.010/sec)</option>
                            <option value="wan">Wan 2.6 ğŸ’ (8ğŸ¬ 0.050/sec)</option>
                            <option value="seedance">Seedance Lite (7ğŸ¬ 1.8/M)</option>
                            <option value="seedance-pro">Seedance Pro-Fast ğŸ’ (7ğŸ¬ 1.0/M)</option>
                            <option value="veo">Veo 3.1 Fast ğŸ’</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="format_label">Format</label>
                        <div class="flex gap-2">
                            <button onclick="setVideoRatio('square', this)" class="ratio-btn flex-1 bg-black/50 border border-white/5 text-gray-400 py-2.5 rounded-lg hover:text-white hover:border-white/20 transition-all text-sm" data-ratio="square"><i class="fa-regular fa-square"></i></button>
                            <button onclick="setVideoRatio('landscape', this)" class="ratio-btn flex-1 bg-purple-500/20 border border-purple-500/50 text-purple-400 py-2.5 rounded-lg transition-all text-sm active-ratio" data-ratio="landscape"><i class="fa-solid fa-image"></i></button>
                            <button onclick="setVideoRatio('portrait', this)" class="ratio-btn flex-1 bg-black/50 border border-white/5 text-gray-400 py-2.5 rounded-lg hover:text-white hover:border-white/20 transition-all text-sm" data-ratio="portrait"><i class="fa-solid fa-mobile-screen"></i></button>
                        </div>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 flex justify-between">
                            <span data-i18n="video_duration_label">Duration (Blocks)</span>
                            <span id="video-duration-val" class="text-white font-mono">5s</span>
                        </label>
                        <input type="range" id="video-duration" min="5" max="10" step="5" value="5" class="w-full accent-purple-500 cursor-pointer" oninput="document.getElementById('video-duration-val').innerText = this.value + 's'">
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 flex justify-between">
                            <span data-i18n="seed_label">Seed</span>
                            <span id="video-seed-val" class="text-white font-mono text-[10px]" data-i18n="seed_random">Random</span>
                        </label>
                        <div class="flex gap-2">
                            <input type="number" id="video-seed" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono" data-i18n-placeholder="seed_placeholder" placeholder="ID...">
                            <button onclick="randomizeVideoSeed()" class="bg-white/5 border border-white/10 text-white px-3.5 rounded-lg hover:bg-white/10 transition-colors" title="Aleatorizar">
                                <i class="fa-solid fa-shuffle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="mt-auto pt-4 border-t border-white/5">
                        <button id="btn-generate-video" onclick="generateVideo()" class="w-full bg-white text-black font-semibold py-3.5 rounded-xl hover:bg-gray-200 active:scale-[0.98] transition-all shadow-[0_0_15px_rgba(255,255,255,0.1)] flex items-center justify-center gap-2 text-xs tracking-widest uppercase">
                            <i class="fa-solid fa-video"></i> <span data-i18n="video_btn_generate">Generate Video</span>
                        </button>
                    </div>
                </div>
                <div class="flex-1 bg-panel border border-white/5 rounded-2xl p-6 flex flex-col relative overflow-hidden shadow-xl">
                    <div id="video-placeholder" class="w-full h-full flex items-center justify-center text-gray-500 flex-col gap-4">
                        <i class="fa-solid fa-film text-5xl opacity-20"></i>
                        <p class="text-sm font-light tracking-wide" data-i18n="video_empty_text">Your generated videos will appear here.</p>
                    </div>
                    <div id="video-gallery" class="w-full h-full overflow-y-auto custom-scrollbar hidden">
                        <div id="video-grid" class="grid grid-cols-1 xl:grid-cols-2 gap-6 pb-10"></div>
                    </div>
                </div>
            </div>

            <div id="section-image" class="tool-section w-full h-full flex gap-6 fade-in hidden">
                <div class="w-80 shrink-0 flex flex-col gap-6 bg-panel border border-white/5 rounded-2xl p-6 overflow-y-auto custom-scrollbar shadow-xl">
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="image_prompt_label">Image Prompt</label>
                        <textarea id="image-prompt" rows="5" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-3 outline-none resize-none placeholder-gray-600 transition-colors" data-i18n-placeholder="image_prompt_placeholder" placeholder="Describe the image visually, lighting, style..."></textarea>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="model_label">AI Model</label>
                        <select id="image-model" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono cursor-pointer appearance-none">
                            <option value="flux">Flux Schnell (5KğŸ–¼ï¸ 0.0002/img)</option>
                            <option value="zimage">Z-Image Turbo (5KğŸ–¼ï¸ 0.0002/img)</option>
                            <option value="klein">FLUX.2 Klein 4B (150ğŸ–¼ï¸ 0.008/img)</option>
                            <option value="klein-large">FLUX.2 Klein 9B (85ğŸ–¼ï¸ 0.012/img)</option>
                            <option value="gptimage">GPT Image 1 Mini (70ğŸ’¬ 2.0/M)</option>
                            <option value="seedream">Seedream 4.0 ğŸ’</option>
                            <option value="kontext">FLUX.1 Kontext ğŸ’</option>
                            <option value="nanobanana">NanoBanana ğŸ’</option>
                            <option value="seedream-pro">Seedream 4.5 Pro ğŸ’</option>
                            <option value="gptimage-large">GPT Image 1.5 ğŸ’</option>
                            <option value="nanobanana-pro">NanoBanana Pro ğŸ’</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="format_label">Format</label>
                        <div class="flex gap-2">
                            <button onclick="setImageRatio('square', this)" class="ratio-btn-img flex-1 bg-black/50 border border-white/5 text-gray-400 py-2.5 rounded-lg hover:text-white hover:border-white/20 transition-all text-sm" data-ratio="square"><i class="fa-regular fa-square"></i></button>
                            <button onclick="setImageRatio('landscape', this)" class="ratio-btn-img flex-1 bg-purple-500/20 border border-purple-500/50 text-purple-400 py-2.5 rounded-lg transition-all text-sm active-ratio" data-ratio="landscape"><i class="fa-solid fa-image"></i></button>
                            <button onclick="setImageRatio('portrait', this)" class="ratio-btn-img flex-1 bg-black/50 border border-white/5 text-gray-400 py-2.5 rounded-lg hover:text-white hover:border-white/20 transition-all text-sm" data-ratio="portrait"><i class="fa-solid fa-mobile-screen"></i></button>
                        </div>
                    </div>
                    <div class="flex gap-4 items-end">
                        <div class="flex-1">
                            <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="image_batch_label">Amount</label>
                            <input type="number" id="image-batch" value="1" min="1" max="10" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono text-center">
                        </div>
                        <div class="flex-1 flex flex-col">
                            <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block text-right" data-i18n="image_chroma_label">Chroma Key</label>
                            <div class="flex items-center justify-end h-[38px]">
                                <input type="checkbox" id="image-chroma-toggle" class="toggle-checkbox" style="display:none">
                                <label for="image-chroma-toggle" class="toggle-label">
                                    <div class="toggle-circle"></div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 flex justify-between">
                            <span data-i18n="image_seed_batch_label">Seed (Batch 1)</span>
                            <span id="image-seed-val" class="text-white font-mono text-[10px]" data-i18n="seed_random">Random</span>
                        </label>
                        <div class="flex gap-2">
                            <input type="number" id="image-seed" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono" data-i18n-placeholder="seed_placeholder" placeholder="ID...">
                            <button onclick="randomizeImageSeed()" class="bg-white/5 border border-white/10 text-white px-3.5 rounded-lg hover:bg-white/10 transition-colors" title="Aleatorizar">
                                <i class="fa-solid fa-shuffle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="mt-auto pt-4 border-t border-white/5">
                        <button id="btn-generate-image" onclick="generateImages()" class="w-full bg-white text-black font-semibold py-3.5 rounded-xl hover:bg-gray-200 active:scale-[0.98] transition-all shadow-[0_0_15px_rgba(255,255,255,0.1)] flex items-center justify-center gap-2 text-xs tracking-widest uppercase">
                            <i class="fa-solid fa-image"></i> <span data-i18n="image_btn_generate">Generate Images</span>
                        </button>
                    </div>
                </div>
                <div class="flex-1 bg-panel border border-white/5 rounded-2xl p-6 flex flex-col relative overflow-hidden shadow-xl">
                    <div id="image-placeholder" class="w-full h-full flex items-center justify-center text-gray-500 flex-col gap-4">
                        <i class="fa-solid fa-cube text-5xl opacity-20"></i>
                        <p class="text-sm font-light tracking-wide" data-i18n="image_empty_text">Your generated images will appear here.</p>
                    </div>
                    <div id="image-gallery" class="w-full h-full overflow-y-auto custom-scrollbar hidden">
                        <div id="image-grid" class="grid grid-cols-2 xl:grid-cols-3 gap-6 pb-10"></div>
                    </div>
                </div>
            </div>

            <div id="section-music" class="tool-section w-full h-full flex gap-6 fade-in hidden">
                <div class="w-80 shrink-0 flex flex-col gap-6 bg-panel border border-white/5 rounded-2xl p-6 overflow-y-auto custom-scrollbar shadow-xl">
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="music_prompt_label">Prompt / Lyrics</label>
                        <textarea id="music-prompt" rows="5" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-3 outline-none resize-none placeholder-gray-600 transition-colors" data-i18n-placeholder="music_prompt_placeholder" placeholder="Describe the music or write the lyrics..."></textarea>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="model_label">AI Model</label>
                        <select id="music-model" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono cursor-pointer appearance-none">
                            <option value="elevenmusic">ElevenLabs Music (3ğŸ¬ 0.0050/sec)</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="music_voice_label">Tone / Base Voice</label>
                        <select id="music-voice" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono cursor-pointer appearance-none">
                            <option value="rachel">Rachel (ElevenLabs)</option>
                            <option value="domi">Domi (ElevenLabs)</option>
                            <option value="bella">Bella (ElevenLabs)</option>
                            <option value="antoni">Antoni (ElevenLabs)</option>
                            <option value="alloy">Alloy (OpenAI)</option>
                            <option value="echo">Echo (OpenAI)</option>
                        </select>
                        <p class="text-[8px] text-gray-500 mt-2" data-i18n="music_voice_note">* API technical requirement, voice selection is required.</p>
                    </div>
                    <div class="mt-auto pt-4 border-t border-white/5">
                        <button id="btn-generate-music" onclick="generateMusic()" class="w-full bg-white text-black font-semibold py-3.5 rounded-xl hover:bg-gray-200 active:scale-[0.98] transition-all shadow-[0_0_15px_rgba(255,255,255,0.1)] flex items-center justify-center gap-2 text-xs tracking-widest uppercase">
                            <i class="fa-solid fa-music"></i> <span data-i18n="music_btn_generate">Generate Music</span>
                        </button>
                    </div>
                </div>
                <div class="flex-1 bg-panel border border-white/5 rounded-2xl p-6 flex flex-col relative overflow-hidden shadow-xl">
                    <div id="music-placeholder" class="w-full h-full flex items-center justify-center text-gray-500 flex-col gap-4">
                        <i class="fa-solid fa-headphones text-5xl opacity-20"></i>
                        <p class="text-sm font-light tracking-wide" data-i18n="music_empty_text">Your music tracks will appear here.</p>
                    </div>
                    <div id="music-gallery" class="w-full h-full overflow-y-auto custom-scrollbar hidden">
                        <div id="music-grid" class="flex flex-col gap-4 pb-10"></div>
                    </div>
                </div>
            </div>

            <div id="section-voice" class="tool-section w-full h-full flex gap-6 fade-in hidden">
                <div class="w-80 shrink-0 flex flex-col gap-6 bg-panel border border-white/5 rounded-2xl p-6 overflow-y-auto custom-scrollbar shadow-xl">
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="voice_prompt_label">Text to Narrate</label>
                        <textarea id="voice-prompt" rows="5" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-3 outline-none resize-none placeholder-gray-600 transition-colors" data-i18n-placeholder="voice_prompt_placeholder" placeholder="Write the text you want the AI to narrate..."></textarea>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="voice_model_label">Voice</label>
                        <select id="voice-model" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono cursor-pointer appearance-none">
                            <option value="alloy">Alloy (Neutra)</option>
                            <option value="echo">Echo (Masculina suave)</option>
                            <option value="fable">Fable (Masculina expresiva)</option>
                            <option value="onyx">Onyx (Masculina grave)</option>
                            <option value="nova">Nova (Femenina energÃ©tica)</option>
                            <option value="shimmer">Shimmer (Femenina clara)</option>
                        </select>
                    </div>
                    <div class="mt-auto pt-4 border-t border-white/5">
                        <button id="btn-generate-voice" onclick="generateVoice()" class="w-full bg-white text-black font-semibold py-3.5 rounded-xl hover:bg-gray-200 active:scale-[0.98] transition-all shadow-[0_0_15px_rgba(255,255,255,0.1)] flex items-center justify-center gap-2 text-xs tracking-widest uppercase">
                            <i class="fa-solid fa-microphone"></i> <span data-i18n="voice_btn_generate">Generate Voice</span>
                        </button>
                    </div>
                </div>
                <div class="flex-1 bg-panel border border-white/5 rounded-2xl p-6 flex flex-col relative overflow-hidden shadow-xl">
                    <div id="voice-placeholder" class="w-full h-full flex items-center justify-center text-gray-500 flex-col gap-4">
                        <i class="fa-solid fa-waveform-lines text-5xl opacity-20"></i>
                        <p class="text-sm font-light tracking-wide" data-i18n="voice_empty_text">Your generated narrations will appear here.</p>
                    </div>
                    <div id="voice-gallery" class="w-full h-full overflow-y-auto custom-scrollbar hidden">
                        <div id="voice-grid" class="flex flex-col gap-4 pb-10"></div>
                    </div>
                </div>
            </div>

            <div id="section-chat" class="tool-section w-full h-full flex gap-6 fade-in hidden">
                <div class="w-80 shrink-0 flex flex-col gap-6 bg-panel border border-white/5 rounded-2xl p-6 overflow-y-auto custom-scrollbar shadow-xl">
                   <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="chat_model_label">Chat Model</label>
                        <select id="chat-model" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-2.5 outline-none font-mono cursor-pointer appearance-none">
                            <option value="qwen-safety">Qwen3Guard 8B (111.1KğŸ’¬)</option>
                            <option value="nova-fast">Amazon Nova Micro (22.2KğŸ’¬)</option>
                            <option value="mistral">Mistral Small 3.2 24B (4.3KğŸ’¬)</option>
                            <option value="gemini-fast">Google Gemini 2.5 Flash Lite ğŸ‘ï¸ğŸ”ğŸ’» (3.1KğŸ’¬)</option>
                            <option value="qwen-coder">Qwen3 Coder 30B (1.2KğŸ’¬)</option>
                            <option value="gemini-search">Google Gemini 2.5 Flash Lite Search ğŸ‘ï¸ğŸ”ğŸ’» (1.6KğŸ’¬)</option>
                            <option value="openai-fast">OpenAI GPT-5 Nano ğŸ‘ï¸ (950ğŸ’¬)</option>
                            <option value="openai">OpenAI GPT-5 Mini ğŸ‘ï¸ (700ğŸ’¬)</option>
                            <option value="grok">xAI Grok 4 Fast ğŸ’ (550ğŸ’¬)</option>
                            <option value="perplexity-fast">Perplexity Sonar ğŸ” (450ğŸ’¬)</option>
                            <option value="minimax">MiniMax M2.1 ğŸ§  (450ğŸ’¬)</option>
                            <option value="deepseek">DeepSeek V3.2 ğŸ§  (250ğŸ’¬)</option>
                            <option value="perplexity-reasoning">Perplexity Sonar Reasoning ğŸ§ ğŸ” (200ğŸ’¬)</option>
                            <option value="openai-audio">OpenAI GPT-4o Mini Audio ğŸ‘ï¸ğŸ™ï¸ğŸ”Š (150ğŸ’¬)</option>
                            <option value="chickytutor">ChickyTutor (100ğŸ’¬)</option>
                            <option value="midijourney">MIDIjourney (100ğŸ’¬)</option>
                            <option value="glm">Z.ai GLM-5 ğŸ§  (100ğŸ’¬)</option>
                            <option value="claude-fast">Anthropic Claude Haiku 4.5 ğŸ‘ï¸ (95ğŸ’¬)</option>
                            <option value="openai-large">OpenAI GPT-5.2 ğŸ‘ï¸ğŸ§  (90ğŸ’¬)</option>
                            <option value="gemini">Google Gemini 3 Flash ğŸ’ ğŸ‘ï¸ğŸ™ï¸ğŸ”ğŸ’» (85ğŸ’¬)</option>
                            <option value="kimi">Moonshot Kimi K2.5 ğŸ‘ï¸ğŸ§  (85ğŸ’¬)</option>
                            <option value="gemini-legacy">Google Gemini 2.5 Pro ğŸ’ ğŸ‘ï¸ğŸ™ï¸ğŸ§ ğŸ”ğŸ’» (30ğŸ’¬)</option>
                            <option value="claude">Anthropic Claude Sonnet 4.5 ğŸ’ ğŸ‘ï¸ (25ğŸ’¬)</option>
                            <option value="gemini-large">Google Gemini 3 Pro ğŸ’ ğŸ‘ï¸ğŸ™ï¸ğŸ§ ğŸ” (25ğŸ’¬)</option>
                            <option value="claude-large">Anthropic Claude Opus 4.6 ğŸ’ ğŸ‘ï¸ (10ğŸ’¬)</option>
                            <option value="claude-legacy">Anthropic Claude Opus 4.5 ğŸ’ ğŸ‘ï¸ (7ğŸ’¬)</option>
                        </select>
                    </div>
                    <div>
                        <label class="text-[10px] text-gray-400 uppercase tracking-widest font-medium mb-2 block" data-i18n="chat_system_label">System Instructions (Context)</label>
                        <textarea id="chat-system" rows="5" class="w-full bg-black/50 border border-white/5 text-white text-sm rounded-lg focus:ring-1 focus:ring-purple-500 block p-3 outline-none resize-none placeholder-gray-600 transition-colors" data-i18n-placeholder="chat_system_placeholder" placeholder="Define personality, format, role or general instructions..."></textarea>
                    </div>
                    <div class="mt-auto pt-4 border-t border-white/5">
                        <button onclick="clearChatHistory()" class="w-full bg-red-500/10 text-red-400 border border-red-500/20 font-semibold py-3.5 rounded-xl hover:bg-red-500/20 active:scale-[0.98] transition-all flex items-center justify-center gap-2 text-xs tracking-widest uppercase">
                            <i class="fa-solid fa-trash-can"></i> <span data-i18n="chat_btn_clear">Clear Memory</span>
                        </button>
                    </div>
                </div>
                <div class="flex-1 bg-panel border border-white/5 rounded-2xl flex flex-col relative overflow-hidden shadow-xl">
                    <div id="chat-messages" class="flex-1 overflow-y-auto custom-scrollbar p-6 flex flex-col gap-4"></div>
                    <div class="p-4 border-t border-white/5 bg-black/20">
                        <div class="flex gap-4">
                            <textarea id="chat-input" rows="1" class="flex-1 bg-black/50 border border-white/5 text-white text-sm rounded-xl focus:ring-1 focus:ring-purple-500 block p-4 outline-none resize-none placeholder-gray-500 transition-colors" data-i18n-placeholder="chat_input_placeholder" placeholder="Type a message... (Shift+Enter for new line)" onkeydown="handleChatKeydown(event)"></textarea>
                            <button id="btn-send-chat" onclick="sendChatMessage()" class="w-14 shrink-0 bg-white text-black font-semibold rounded-xl hover:bg-gray-200 active:scale-[0.98] transition-all shadow-[0_0_15px_rgba(255,255,255,0.1)] flex items-center justify-center text-lg">
                                <i class="fa-solid fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <canvas id="hidden-canvas" style="display: none;"></canvas>
        </div>
    </main>

    <div id="lightbox-modal" onclick="closeLightbox()" class="fixed inset-0 z-[200] bg-black/95 hidden flex items-center justify-center cursor-zoom-out transition-opacity duration-300 opacity-0 backdrop-blur-sm">
        <img id="lightbox-image" class="max-w-[95vw] max-h-[95vh] object-contain shadow-2xl rounded-lg" src="" alt="Full view" onclick="event.stopPropagation()">
        <button onclick="closeLightbox()" class="absolute top-6 right-8 text-white/50 hover:text-white text-3xl transition-colors">
            <i class="fa-solid fa-xmark"></i>
        </button>
    </div>

    <div id="login-modal" class="hidden fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm transition-opacity duration-300 opacity-0 flex items-center justify-center" onclick="toggleLoginModal()">
        <div class="glass-card w-full max-w-md p-8 rounded-3xl flex flex-col items-center relative shadow-[0_0_50px_rgba(0,0,0,0.8)]" onclick="event.stopPropagation()">
            <button onclick="toggleLoginModal()" class="absolute top-5 right-5 text-gray-500 hover:text-white transition-colors">
                <i class="fa-solid fa-xmark text-xl"></i>
            </button>
            
            <div class="w-16 h-16 rounded-full bg-gradient-to-tr from-purple-600 to-blue-500 flex items-center justify-center mb-6 shadow-[0_0_30px_rgba(168,85,247,0.4)]">
                <i class="fa-solid fa-user-shield text-2xl text-white"></i>
            </div>
            
            <h2 class="text-2xl font-semibold mb-2 text-white text-center" data-i18n="login_title">Conectar a Pollination</h2>
            <p class="text-sm text-gray-400 text-center mb-8" data-i18n="login_subtitle">Introduce tu token para usar la IA.</p>
            
            <button onclick="loginWithPollinations()" class="w-full bg-[#1f1f23] border border-white/10 hover:bg-white/10 text-white font-medium py-3.5 rounded-xl transition-all flex items-center justify-center gap-3 mb-6 shadow-lg">
                <img src="https://pollinations.ai/favicon.ico" alt="Pollinations Logo" class="w-5 h-5 rounded-sm">
                <span>Continuar con Pollinations</span>
                <i class="fa-solid fa-arrow-up-right-from-square text-xs text-gray-500 ml-1"></i>
            </button>

            <div class="w-full flex items-center gap-3 mb-6">
                <div class="h-px bg-white/10 flex-1"></div>
                <span class="text-[10px] text-gray-500 uppercase tracking-widest font-medium">O pega tu token</span>
                <div class="h-px bg-white/10 flex-1"></div>
            </div>

            <div class="w-full relative mb-5">
                <i class="fa-solid fa-key absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm"></i>
                <input type="password" id="pollination-token-input" data-i18n-placeholder="login_placeholder" placeholder="Pega tu API Key..." class="w-full bg-black/50 border border-white/10 text-white text-sm rounded-xl focus:ring-1 focus:ring-purple-500 focus:border-transparent block pl-11 p-3.5 transition-all outline-none font-mono tracking-wider">
            </div>
            
            <button id="btn-login" class="w-full bg-white text-black font-semibold py-3.5 rounded-xl hover:bg-gray-200 transition-colors shadow-lg active:scale-[0.98] text-sm uppercase tracking-widest" data-i18n="login_button">
                Iniciar SesiÃ³n
            </button>
            
            <p class="mt-6 text-[11px] text-gray-500 text-center leading-relaxed" data-i18n="login_footer">La clave se guarda localmente de forma segura en tu navegador.</p>
        </div>
    </div>

    <script src="i18n.js"></script>
    <script src="video.js"></script>
    <script src="image.js"></script>
    <script src="music.js"></script> 
    <script src="voice.js"></script> 
    <script src="chat.js"></script> 
    
    <script>
        // --- INTERCEPTOR DE REDIRECCIÃ“N PARA LOGIN AUTOMÃTICO ---
        (function checkAuthRedirect() {
            const hash = window.location.hash;
            if (!hash) return;
            const params = new URLSearchParams(hash.substring(1));
            const key = params.get('api_key') || params.get('key') || params.get('access_token');
            
            if (key && window.opener) {
                if (document.body) document.body.style.display = 'none';
                window.opener.postMessage({
                    type: 'POLLI_AUTH_SUCCESS',
                    key: key
                }, '*');
                window.close();
            }
        })();

        function loginWithPollinations() {
            const redirectUrl = encodeURIComponent(window.location.href);
            window.open(`https://enter.pollinations.ai/authorize?redirect_url=${redirectUrl}`, 'PollinationsAuth', `width=500,height=700,left=${(screen.width/2-250)},top=${(screen.height/2-350)}`);
        }

        // Ahora en lugar de mostrar un div oculto, devolvemos al usuario a la pÃ¡gina de inicio
        function showLanding() {
            window.location.href = 'index.html';
        }

        function toggleLoginModal() {
            const modal = document.getElementById('login-modal');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
            } else {
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }

        // LÃ“GICA DEL MENÃš LATERAL (Tabs)
        document.querySelectorAll('.tool-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
                const buttonElement = e.currentTarget;
                buttonElement.classList.add('active');
                
                const toolName = buttonElement.dataset.tool;
                const toolTitle = buttonElement.querySelector('span').innerText;
                document.getElementById('current-tool-title').innerText = toolTitle;
                
                document.querySelectorAll('.tool-section').forEach(sec => sec.classList.add('hidden'));
                
                const targetSection = document.getElementById(`section-${toolName}`);
                if (targetSection) {
                    targetSection.classList.remove('hidden');
                }
            });
        });

        // LÃ“GICA DE API Y ESTADO DE CONEXIÃ“N
        function setApiConnectedState(token) {
            localStorage.setItem('pollinations_api_key', token);
            document.getElementById('pollination-token-input').value = token;
            
            const dot = document.getElementById('status-dot');
            if (dot) dot.classList.replace('bg-red-500', 'bg-green-500');
            
            const text = document.getElementById('status-text');
            if (text) text.setAttribute('data-i18n', 'status_connected');
            
            if (typeof updateDOM === 'function') updateDOM(); 
            
            // Cerrar el modal si estÃ¡ abierto
            const modal = document.getElementById('login-modal');
            if (modal && !modal.classList.contains('hidden')) {
                toggleLoginModal();
            }
        }

        document.getElementById('btn-login').addEventListener('click', () => {
            const token = document.getElementById('pollination-token-input').value.trim();
            if(token) {
                setApiConnectedState(token);
            }
        });

        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'POLLI_AUTH_SUCCESS' && event.data.key) {
                setApiConnectedState(event.data.key);
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            // Revisar si venimos de un enlace desde index.html con el parÃ¡metro ?tool=...
            const params = new URLSearchParams(window.location.search);
            const toolFromUrl = params.get('tool');
            if (toolFromUrl) {
                const btnTool = document.querySelector(`[data-tool="${toolFromUrl}"]`);
                if (btnTool) btnTool.click();
            }

            // Comprobar la conexiÃ³n existente de la API
            const savedKey = localStorage.getItem('pollinations_api_key');
            if(savedKey) {
                document.getElementById('pollination-token-input').value = savedKey;
                const dot = document.getElementById('status-dot');
                if(dot) dot.classList.replace('bg-red-500', 'bg-green-500');
                const text = document.getElementById('status-text');
                if(text) text.setAttribute('data-i18n', 'status_connected');
            }
            
            if(typeof randomizeVideoSeed === 'function') randomizeVideoSeed();
            if(typeof randomizeImageSeed === 'function') randomizeImageSeed();
        });
    </script>
</body>
</html>